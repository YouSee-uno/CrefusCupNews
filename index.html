<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CrefusCup é †ä½é€Ÿå ±</title>
    <link href="https://fonts.googleapis.com/css2?family=BIZ+UDGothic:wght@400;700&display=swap" rel="stylesheet">
    <script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
    <style>
        :root {
            /* èƒŒæ™¯ã‚’å®Œå…¨ã«ä¸é€æ˜ãªç™½ã«è¨­å®š */
            --table-bg: #ffffff;
            --header-bg: #f2f2f2;
            --border-color: #dddddd;
        }

        body {
            background: linear-gradient(135deg, #a8e063 0%, #56ab2f 100%);
            font-family: 'BIZ UDGothic', sans-serif;
            margin: 0;
            display: flex;
            flex-direction: column;
            align-items: center;
            min-height: 100vh;
            color: #000000; /* æ–‡å­—ã‚’å®Œå…¨ãªé»’ã« */
            padding: 20px 10px;
            box-sizing: border-box;
        }

        h1 {
            color: #ffffff;
            text-shadow: 0 2px 4px rgba(0,0,0,0.3);
            margin-bottom: 20px;
            font-size: clamp(1.2rem, 5vw, 1.8rem);
        }

        /* ã‚¿ãƒ–ã‚³ãƒ³ãƒ†ãƒŠ */
        .tab-container {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            gap: 8px;
            max-width: 900px;
            margin-bottom: 20px;
        }

        .tab-button {
            background: rgba(0, 0, 0, 0.15);
            border: 1px solid rgba(255, 255, 255, 0.5);
            color: white;
            padding: 8px 16px;
            border-radius: 30px;
            cursor: pointer;
            font-size: 0.85rem;
            transition: all 0.2s ease;
        }

        .tab-button.active {
            background: white;
            color: #458a25;
            font-weight: bold;
            box-shadow: 0 4px 10px rgba(0,0,0,0.2);
        }

        /* --- ãƒ†ãƒ¼ãƒ–ãƒ«å…¨ä½“ã®ã‚³ãƒ³ãƒ†ãƒŠ --- */
        .scroll-container {
            width: 100%;
            max-width: 800px;
            height: 70vh;
            overflow-y: auto;
            background: var(--table-bg); /* å®Œå…¨ãªç™½ */
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
            border: 1px solid var(--border-color);
        }

        table {
            width: 100%;
            border-collapse: separate;
            border-spacing: 0;
            text-align: center;
        }

        /* ã‚¿ã‚¤ãƒˆãƒ«éƒ¨åˆ†ï¼ˆãƒ˜ãƒƒãƒ€ãƒ¼ï¼‰ã®å›ºå®š */
        thead th {
            position: sticky;
            top: 0;
            z-index: 20;
            background: var(--header-bg);
            color: #000000;
            padding: 18px 10px;
            font-weight: bold;
            border-bottom: 2px solid #bbb;
        }

        /* ãƒ‡ãƒ¼ã‚¿éƒ¨åˆ† */
        tbody td {
            padding: 15px 10px;
            border-bottom: 1px solid var(--border-color);
            font-size: 1.1rem;
            color: #000000;
            background-color: #ffffff; /* è¡Œã®èƒŒæ™¯ã‚‚ç™½ã«å›ºå®š */
        }

        /* 1ä½ã€œ3ä½ã®å¼·èª¿ï¼ˆä¸é€æ˜ãªè‰²ã§è¨­å®šï¼‰ */
        tr:nth-child(1) td { background-color: #fff4b0 !important; font-weight: bold; } /* ã‚´ãƒ¼ãƒ«ãƒ‰ */
        tr:nth-child(2) td { background-color: #f0f0f0 !important; } /* ã‚·ãƒ«ãƒãƒ¼ */
        tr:nth-child(3) td { background-color: #f9e8d9 !important; } /* ãƒ–ãƒ­ãƒ³ã‚º */

        /* ãƒ­ãƒ¼ãƒ‰ä¸­ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ */
        .loading {
            padding: 40px;
            text-align: center;
            font-weight: bold;
        }
    </style>
</head>
<body>

    <h1>ğŸ† CrefusCup é †ä½é€Ÿå ±</h1>
    
    <div class="tab-container">
        <button class="tab-button active" onclick="switchTab('bronze', this)">ãƒ–ãƒ­ãƒ³ã‚º</button>
        <button class="tab-button" onclick="switchTab('silver', this)">ã‚·ãƒ«ãƒãƒ¼</button>
        <button class="tab-button" onclick="switchTab('gold', this)">ã‚´ãƒ¼ãƒ«ãƒ‰</button>
        <button class="tab-button" onclick="switchTab('platinum', this)">ãƒ—ãƒ©ãƒãƒŠ</button>
        <button class="tab-button" onclick="switchTab('m2spike', this)">M2 SPIKE</button>
        <button class="tab-button" onclick="switchTab('m2ev3', this)">M2 EV3</button>
        <button class="tab-button" onclick="switchTab('m3', this)">M3</button>
    </div>
    
    <div class="scroll-container">
        <table id="result_table">
            <thead>
                <tr>
                    <th>é †ä½</th>
                    <th>é¸æ‰‹ç•ªå·</th>
                    <th>æœ€é«˜ç‚¹</th>
                    <th>ã‚¯ãƒªã‚¢ã‚¿ã‚¤ãƒ </th>
                </tr>
            </thead>
            <tbody id="table_body">
                <tr><td colspan="4" class="loading">ãƒ‡ãƒ¼ã‚¿ã‚’å–å¾—ä¸­...</td></tr>
            </tbody>
        </table>
    </div>

    <script type="text/javascript">
        const spreadsheetIds = {
            'bronze': '1k2Gdgpl1BojoH9FB2x4_kvJfYPrqRDWAWpmKlLKf7_w',
            'silver': '1InuKN189VS-mClhAM1vsYU2NE5QFq8_Mut3mp1tQkkE',
            'gold': '1ZIZKXQGa4XCodWRUTc55DZ1o4xFUsQflaU-x5vo90bI',
            'platinum': '1AG7oRVh5_de9JcWl9Mcw7qWWtka8Dsc9fv43O7f54PM',
            'm2spike': '1CBarwg3feFZrW8HLY6D2sVzzEU2QoVmyas0qYJFByJU',
            'm2ev3': '1pubGzi3MIBKK6fLFD6kkgBsFAHRQPHqkHdq2SJDM35g',
            'm3': '1ZkjPfGBQ47ih1-eIhp-45ThnAbctC4ROvWFuPyIdZEc'
        };

        const range = 'B4:E28'; 
        let currentCourse = 'bronze';

        google.charts.load('current', {'packages':['corechart']});
        google.charts.setOnLoadCallback(fetchData);

        function switchTab(courseKey, element) {
            currentCourse = courseKey;
            const buttons = document.querySelectorAll('.tab-button');
            buttons.forEach(btn => btn.classList.remove('active'));
            element.classList.add('active');
            
            document.getElementById('table_body').innerHTML = `<tr><td colspan="4" class="loading">èª­ã¿è¾¼ã¿ä¸­...</td></tr>`;
            fetchData();
        }

        function fetchData() {
            const id = spreadsheetIds[currentCourse];
            const query = new google.visualization.Query(
                `https://docs.google.com/spreadsheets/d/${id}/gviz/tq?range=${range}`
            );
            query.send(handleResponse);
        }

        function handleResponse(response) {
            if (response.isError()) {
                document.getElementById('table_body').innerHTML = `<tr><td colspan="4" class="loading">ã‚¨ãƒ©ãƒ¼: ã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰ã‚·ãƒ¼ãƒˆã®å…¬é–‹è¨­å®šã‚’ç¢ºèªã—ã¦ãã ã•ã„</td></tr>`;
                return;
            }
            const data = response.getDataTable();
            const rowCount = data.getNumberOfRows();
            let html = "";

            for (let i = 0; i < rowCount; i++) {
                html += "<tr>";
                html += `<td>${data.getFormattedValue(i, 0)}</td>`;
                html += `<td>${data.getFormattedValue(i, 1)}</td>`;
                html += `<td>${data.getFormattedValue(i, 2)}</td>`;
                html += `<td>${data.getFormattedValue(i, 3)}</td>`;
                html += "</tr>";
            }
            document.getElementById('table_body').innerHTML = html;
        }

        // 30ç§’ã”ã¨ã«è‡ªå‹•æ›´æ–°
        setInterval(fetchData, 30000);
    </script>
</body>
</html>